<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wellness Wave</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">

     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script src="https://kit.fontawesome.com/yourkitid.js" crossorigin="anonymous"></script>
<style>
    #resultsCard {
      border-left: 6px solid #0d6efd;
    }
    #resultsCard .col-sm-3 {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .status-normal { color: green; font-weight: 600; }
    .status-moderate { color: orange; font-weight: 600; }
    .status-high { color: red; font-weight: 600; }
  </style>
</head>
<body class="bg-light text-dark">

       <!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light  px-4" style="background-color:#efefef;">
  <a class="navbar-brand d-flex align-items-center" href="#" style="padding-left: 30px;">

    <span><strong>Wellness Wave</strong> <small class="text-danger">| Family Doctor</small></span>
  </a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse justify-content-end" id="navbarNav" style="padding-right: 100px;">
    <ul class="navbar-nav align-items-center">

      <li class="nav-item"><a class="nav-link" href="{{ url_for('back_page') }}">Back</a></li>
    </ul>
  </div>
</nav>

    


  <div class="container py-5">
    <!-- Form Card -->
    <div class="card shadow-sm border-0 mb-5">
      <div class="card-body p-4">
        <h1 class="h4 fw-bold mb-4">
           Health Assessment Form
        </h1>

        <form id="healthForm" class="row g-4">
          <!-- Personal Info -->
          <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Personal Information</h5>

            <div class="mb-3">
              <label for="age" class="form-label">Age</label>
              <input type="number" id="age" name="age" value="30" class="form-control" min="1" max="120">
            </div>

            <div class="mb-3">
              <label for="gender" class="form-label">Gender</label>
              <select id="gender" name="gender" class="form-select">
                <option>Male</option>
                <option>Female</option>
                <option>Other</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="height" class="form-label">Height (cm)</label>
              <input type="number" id="height" name="height" value="170" class="form-control" min="50" max="250">
            </div>

            <div class="mb-3">
              <label for="weight" class="form-label">Weight (kg)</label>
              <input type="number" id="weight" name="weight" value="70" class="form-control" min="20" max="200">
            </div>
          </div>

          <!-- Lifestyle -->
          <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Lifestyle Factors</h5>

            <div class="mb-3">
              <label for="smoking" class="form-label">Smoking Status</label>
              <select id="smoking" name="smoking" class="form-select">
                <option>Never</option>
                <option>Former</option>
                <option>Current</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="alcohol" class="form-label">Alcohol Consumption</label>
              <select id="alcohol" name="alcohol" class="form-select">
                <option>None</option>
                <option>Occasional</option>
                <option>Daily</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="exercise" class="form-label">Exercise Frequency</label>
              <select id="exercise" name="exercise" class="form-select">
                <option>None</option>
                <option>1-2 times/week</option>
                <option>3-4 times/week</option>
                <option>5+ times/week</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="sleep" class="form-label">Average Sleep Hours</label>
              <input type="range" id="sleep" name="sleep" min="4" max="12" value="8" class="form-range">
              <small class="text-muted">Selected: <span id="sleepValue">8</span> hours</small>
            </div>
          </div>

          <!-- Health Metrics -->
          <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Health Metrics</h5>

            <div class="mb-3">
              <label for="systolic" class="form-label">Systolic BP</label>
              <input type="number" id="systolic" name="systolic" value="120" class="form-control" min="70" max="250">
            </div>

            <div class="mb-3">
              <label for="diastolic" class="form-label">Diastolic BP</label>
              <input type="number" id="diastolic" name="diastolic" value="80" class="form-control" min="40" max="150">
            </div>

            <div class="mb-3">
              <label for="cholesterol" class="form-label">Cholesterol (mg/dL)</label>
              <input type="number" id="cholesterol" name="cholesterol" value="200" class="form-control" min="100" max="400">
            </div>

            <div class="mb-3">
              <label for="bloodSugar" class="form-label">Blood Sugar (mg/dL)</label>
              <input type="number" id="bloodSugar" name="bloodSugar" value="100" class="form-control" min="50" max="300">
            </div>
          </div>

          <!-- Family & Symptoms -->
          <div class="col-md-6">
            <h5 class="fw-semibold mb-3">Family History & Symptoms</h5>

            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="familyDiabetes" name="familyDiabetes">
              <label class="form-check-label" for="familyDiabetes">Diabetes</label>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="familyHeart" name="familyHeart">
              <label class="form-check-label" for="familyHeart">Heart Disease</label>
            </div>
            <div class="form-check mb-3">
              <input type="checkbox" class="form-check-input" id="familyHypertension" name="familyHypertension">
              <label class="form-check-label" for="familyHypertension">Hypertension</label>
            </div>

            <label for="symptoms" class="form-label">Symptoms</label>
            <select id="symptoms" name="symptoms" class="form-select" multiple size="4">
              <option>Headaches</option>
              <option>Frequent Urination</option>
              <option>Dizziness</option>
              <option>Fatigue</option>
              <option>Nausea</option>
              <option>Shortness of Breath</option>
              <option>Chest Pain</option>
            </select>
          </div>

          <!-- Submit -->
          <div class="col-12">
            <button type="submit" class="btn btn-danger w-100">
             Analyze Health Risks
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Results Card -->
  <div class="card shadow-sm border-0" id="resultsCard" style="display:none;" data-aos="fade-up">
    <div class="card-body">
      <h5 class="fw-bold mb-4"> Health Risk Results</h5>
      <div class="row text-center mb-3">
        <div class="col-sm-3">
          <h3 id="resultBMI">-</h3>
          <p class="mb-0">BMI</p>
          <small id="bmiStatus"></small>
        </div>
        <div class="col-sm-3">
          <h3 id="resultBP">-</h3>
          <p class="mb-0">Blood Pressure</p>
          <small id="bpStatus"></small>
        </div>
        <div class="col-sm-3">
          <h3 id="resultCholesterol">-</h3>
          <p class="mb-0">Cholesterol</p>
          <small id="cholStatus"></small>
        </div>
        <div class="col-sm-3">
          <h3 id="resultBloodSugar">-</h3>
          <p class="mb-0">Blood Sugar</p>
          <small id="sugarStatus"></small>
        </div>
      </div>
      <div id="diseaseResults" class="d-flex flex-wrap justify-content-center gap-3 mt-3"></div>
    </div>
  </div>
</div>

<!--<div class="card shadow-sm border-0 mt-4 bg-light text-dark">
  <div class="card-body">
    <canvas id="diseaseChart" class="bg-light text-dark" style="margin-left:300px; height:400px"></canvas>
  </div>
</div>-->


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const sleepInput = document.getElementById("sleep");
const sleepValue = document.getElementById("sleepValue");
sleepInput.addEventListener("input", () => sleepValue.textContent = sleepInput.value);

const form = document.getElementById("healthForm");
const resultsCard = document.getElementById("resultsCard");
const resultBMI = document.getElementById("resultBMI");
const bmiStatus = document.getElementById("bmiStatus");
const resultBP = document.getElementById("resultBP");
const bpStatus = document.getElementById("bpStatus");
const resultCholesterol = document.getElementById("resultCholesterol");
const cholStatus = document.getElementById("cholStatus");
const resultBloodSugar = document.getElementById("resultBloodSugar");
const sugarStatus = document.getElementById("sugarStatus");
const diseaseDiv = document.getElementById("diseaseResults");

function getStatusClass(status) {
  if (["Normal", "Desirable"].includes(status)) return "status-normal";
  if (["Prediabetes", "Elevated", "Borderline High", "Overweight"].includes(status)) return "status-moderate";
  return "status-high";
}

function metricStatus(name, value) {
  if (name === "BMI") {
    if (value < 18.5) return "Underweight";
    else if (value < 25) return "Normal";
    else if (value < 30) return "Overweight";
    else return "Obese";
  }
  if (name === "BloodSugar") {
    if (value < 100) return "Normal";
    else if (value < 126) return "Prediabetes";
    else return "High";
  }
  if (name === "BloodPressure") {
    const [s,d] = value;
    if (s < 120 && d < 80) return "Normal";
    else if (s < 130 && d < 80) return "Elevated";
    else if (s < 140 || d < 90) return "High Stage 1";
    else return "High Stage 2";
  }
  if (name === "Cholesterol") {
    if (value < 200) return "Desirable";
    else if (value < 240) return "Borderline High";
    else return "High";
  }
  return "Unknown";
}

function getRiskClass(status) {
  if (status === "Low Risk") return "text-success fw-bold";
  if (status === "Intermediate Risk") return "text-warning fw-bold";
  return "text-danger fw-bold";
}

    

form.addEventListener("submit", async e => {
  e.preventDefault();
  const formData = new FormData(form);
  const data = Object.fromEntries(formData.entries());
  data.sleep = sleepInput.value;

  const height = parseFloat(data.height);
  const weight = parseFloat(data.weight);
  const systolic = parseFloat(data.systolic);
  const diastolic = parseFloat(data.diastolic);
  const cholesterol = parseFloat(data.cholesterol);
  const bloodSugar = parseFloat(data.bloodSugar);
  const bmi = (weight / ((height / 100) ** 2)).toFixed(1);

  // Update metric cards
  resultBMI.textContent = bmi;
  let s = metricStatus("BMI", bmi); bmiStatus.textContent = s; bmiStatus.className = getStatusClass(s);
  resultBP.textContent = systolic + "/" + diastolic;
  s = metricStatus("BloodPressure", [systolic, diastolic]); bpStatus.textContent = s; bpStatus.className = getStatusClass(s);
  resultCholesterol.textContent = cholesterol + " mg/dL";
  s = metricStatus("Cholesterol", cholesterol); cholStatus.textContent = s; cholStatus.className = getStatusClass(s);
  resultBloodSugar.textContent = bloodSugar + " mg/dL";
  s = metricStatus("BloodSugar", bloodSugar); sugarStatus.textContent = s; sugarStatus.className = getStatusClass(s);

  resultsCard.style.display = "block";

  const response = await fetch("/predict", { method: "POST", body: new URLSearchParams(data) });
  const result = await response.json();

  // Update disease cards
  let diseaseHtml = "";
  for (const [disease, info] of Object.entries(result.diseases)) {
    diseaseHtml += `
      <div class="card p-3 text-center" style="min-width: 160px; border:none;box-shadow: none !important;">
        <h6 class="mb-1">${disease}</h6>
        <p class="mb-0">${info.chance} <br> <span class="${getRiskClass(info.status)}">${info.status}</span></p>
      </div>`;
  }
  diseaseDiv.innerHTML = diseaseHtml;

  // Update bar chart
  updateDiseaseChart(result.diseases);
});
</script>


<script>
  AOS.init({ duration: 800, once: false, mirror: true, easing: 'ease-in-out' });
</script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  
</body>
</html>
